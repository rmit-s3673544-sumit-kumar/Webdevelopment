<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
        <link rel="stylesheet" href="newcss.css">
        <link rel="icon" href="data:;base64,iVBORw0KGgo=">
        <style>
            #map {
                height: 400px;                
                border: 1px gray solid;}
            h3{
                color: black;
            }
            .main{
                display: block;			
                border: 1px gray solid;
                background: white ;
            }
            a#location{
                text-decoration: none;
            }
        </style>
    </head>

    <body background="pasta.jpg">		
        <nav class="navbar navbar-inverse">
            <div class="container-fluid">

                <!-- Logo -->
                <div class="navbar-header">
                    <a href="#" class="navbar-brand">WinkyFood</a>
                </div>

                <!-- Menu Items -->
                <div>
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="index.html">Home</a></li>
                        <li><a href="navbartoggle.html">About</a></li>
                        <li><a href="contactus.html">Contact</a></li>

                       
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <button type="submit" class="btn navbar-btn btn-success" data-toggle="modal" data-target="#sumit">Signup</button>
                        <div class="modal fade" id="sumit">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                    <!-- header -->
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        <h3 class="modal-title">Sign up</h3>
                                    </div>

                                    <!-- body (form) -->
                                    <div class="modal-body">
                                        <form role="form">
                                            <div class="form-group">
                                                <input type="name" class="form-control" placeholder="Name">
                                            </div>
                                            <div class="form-group">
                                                <input type="email" class="form-control" placeholder="Email">
                                            </div>
                                            <div class="form-group">
                                                <input type="newpassword" class="form-control" placeholder="New Password">
                                            </div>
                                            <div class="form-group">
                                                <input type="retype password" class="form-control" placeholder="Re-type Password">
                                            </div>
                                        </form>
                                    </div> 

                                    <!-- button -->
                                    <div class="modal-footer">
                                        <button class="btn btn-primary btn-block">Submit</button>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </ul> 
                    <!--right align -->
                    <ul class="nav navbar-nav navbar-right">
                        <button type="button" class="btn navbar-btn btn-success" data-toggle="modal" data-target="#popUpWindow">Login</button>
                        <div class="modal fade" id="popUpWindow">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                    <!-- header -->
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        <h3 class="modal-title">Log In</h3>
                                    </div>

                                    <!-- body (form) -->
                                    <div class="modal-body">
                                        <form role="form">
                                            <div class="form-group">
                                                <input type="email" class="form-control" placeholder="Email">
                                            </div>
                                            <div class="form-group">
                                                <input type="password" class="form-control" placeholder="Password">
                                            </div>
                                        </form>
                                    </div>

                                    <!-- button -->
                                    <div class="modal-footer">
                                        <button class="btn btn-primary btn-block">Submit</button>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </ul>


                </div>

            </div>
        </nav>

        <div class="container">
            <div class="row">
                <div class='col-md-10 col-md-offset-1 main'>
                    <h3>Restaurant Finder</h3>
                    <div class= ' row'>
                        <div class="form-group col-md-8"> 
                            <div class="input-group location-bar"> 
                                <input type="text" class="form-control" aria-label="Choose Location" placeholder="Choose Location" id='user-location' name='user-location'>
                                <span class="input-group-addon" title='use current location'>
                                    <a href="#" id="location"><span class="glyphicon glyphicon-globe"></span> Use Current Location</a>
                                </span>
                            </div>
                        </div>
                        <div class="form-group col-md-2"> 
                            <select id="distance" name= 'distance' title='Choose distance' class='form-control' placeholder='Choose Distance'>
                                <option selected value='1'>Distance</option>
                                <option value='5'>5 Km</option>
                                <option value="10">10 Km</option>
                                <option value="15">15 Km</option>
                                <option value="20">20 Km</option>
                            </select> 
                        </div> 
                        <div class="form-group col-md-2"> 
                            <button type="submit" class="btn btn-primary col-md-12" id='findLocations' name='findLocations'>Search</button>
                        </div>                        
                    </div>
                    <div>                        
                        <h3>Results</h3>
                        <div id="map"></div>
                    </div>		
                </div>
            </div>
        </div>

        <div style="display: none" class="infowinfow">
            <div id="info-content">
                <table>
                    <tr id="iw-url-row" class="iw_table_row">
                        <td id="iw-icon" class="iw_table_icon"></td>
                        <td id="iw-url"></td>
                    </tr>
                    <tr id="iw-address-row" class="iw_table_row">
                        <td class="iw_attribute_name">Address:</td>
                        <td id="iw-address"></td>
                    </tr>
                    <tr id="iw-phone-row" class="iw_table_row">
                        <td class="iw_attribute_name">Telephone:</td>
                        <td id="iw-phone"></td>
                    </tr>
                    <tr id="iw-rating-row" class="iw_table_row">
                        <td class="iw_attribute_name">Rating:</td>
                        <td id="iw-rating"></td>
                    </tr>
                    <tr id="iw-website-row" class="iw_table_row">
                        <td class="iw_attribute_name">Website:</td>
                        <td id="iw-website"></td>
                    </tr>
                </table>
            </div>
        </div>
    </body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script>
        var coor, map, places, infoWindow;
        var marker, markers = [];
        var autocomplete;
        var countryRestrict = {'country': 'au'};
        var MARKER_PATH = 'https://developers.google.com/maps/documentation/javascript/images/marker_green';
        var hostnameRegexp = new RegExp('^https?://.+?/');

        var countries = {
            'au': {
                center: {lat: -25.3, lng: 133.8},
                zoom: 4
            }
        };

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: countries['au'].zoom,
                center: countries['au'].center,
                mapTypeControl: true,
                panControl: true,
                zoomControl: true,
                streetViewControl: true
            });

            infoWindow = new google.maps.InfoWindow({
                content: document.getElementById('map')
            });

            // Create the autocomplete object and associate it with the UI input control.
            // Restrict the search to the default country, and to place type "cities".
            autocomplete = new google.maps.places.Autocomplete(
                    /** @type {!HTMLInputElement} */ (
                            document.getElementById('user-location')), {
                types: ['(cities)'],
                componentRestrictions: countryRestrict
            });
            places = new google.maps.places.PlacesService(map);
            autocomplete.addListener('place_changed', onPlaceChanged);
        }


        $('#user-location').val('');
        $('a#location').click(function () {
            if (marker)
                marker.setMap(null);
            clearMarkers();
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition);
                $('#user-location').val("User's Current Location Selected");
            } else {
                alert("Geolocation is not supported by this browser.")
            }
            function showPosition(position) {
                coor = {lat: position.coords.latitude, lng: position.coords.longitude};
                getGeoCoderofPlace(coor);
            }
        });

        if (infoWindow)
            infoWindow.close();
// When the user selects a city, get the place details for the city and
// zoom the map in on the city.
        function onPlaceChanged() {
            var place = autocomplete.getPlace();
            if (place.geometry) {
                coor = {lat: place.geometry.location.lat(), lng: place.geometry.location.lng()};
                getGeoCoderofPlace(coor);
            } else {
                document.getElementById('autocomplete').placeholder = 'Choose Location';
            }
        }

        $('#findLocations').click(function () {
            // validation
            if ($('#user-location').val() == '') {
                alert('Choose location');
                return;
            }
            var search = {
                location: coor,
                types: ['food'],
                radius: parseInt($('#distance').find(":selected").val()) * 100
            };

            places.nearbySearch(search, function (results, status) {
                if (status === google.maps.places.PlacesServiceStatus.OK) {
                    clearMarkers();

                    // Create a marker for each hotel found, and
                    // assign a letter of the alphabetic to each marker icon.
                    for (var i = 0; i < results.length; i++) {
                        var markerLetter = String.fromCharCode('A'.charCodeAt(0) + (i % 26));
                        var markerIcon = MARKER_PATH + markerLetter + '.png';
                        // Use marker animation to drop the icons incrementally on the map.
                        markers[i] = new google.maps.Marker({
                            position: results[i].geometry.location,
                            animation: google.maps.Animation.DROP,
                            icon: markerIcon
                        });
                        // If the user clicks a hotel marker, show the details of that hotel
                        // in an info window.
                        markers[i].placeResult = results[i];
                        google.maps.event.addListener(markers[i], 'click', showInfoWindow);
                        setTimeout(dropMarker(i), i * 100);
                    }
                    map.setZoom(15);
                }
            });
        });

        function clearMarkers() {
            for (var i = 0; i < markers.length; i++) {
                if (markers[i]) {
                    markers[i].setMap(null);
                }
            }
            markers = [];
        }

        function dropMarker(i) {
            return function () {
                markers[i].setMap(map);
            };
        }

// Get the place details for a hotel. Show the information in an info window,
// anchored on the marker for the hotel that the user selected.
        function showInfoWindow() {
            var marker = this;
            places.getDetails({placeId: marker.placeResult.place_id},
                    function (place, status) {
                        if (status !== google.maps.places.PlacesServiceStatus.OK) {
                            return;
                        }
                        writeContent(place, marker);
                        infoWindow.open(map, marker);

                    });
        }

// Load the place information into the HTML elements used by the info window.
        function writeContent(place, marker) {
            var infoNode = $('#info-content');
            infoNode.find('#iw-icon').html('<img class="hotelIcon" ' +
                    'src="' + place.icon + '"/>');
            infoNode.find('#iw-url').html('<b><a href="' + place.url +
                    '">' + place.name + '</a></b>');
            infoNode.find('#iw-address').text(place.vicinity);

            if (place.formatted_phone_number) {
                infoNode.find('#iw-phone-row').css('display', '');
                infoNode.find('#iw-phone').text(
                        place.formatted_phone_number);
            } else {
                infoNode.find('#iw-phone-row').css('display', 'none');
            }

            // Assign a five-star rating to the hotel, using a black star ('&#10029;')
            // to indicate the rating the hotel has earned, and a white star ('&#10025;')
            // for the rating points not achieved.
            if (place.rating) {
                var ratingHtml = '';
                for (var i = 0; i < 5; i++) {
                    if (place.rating < (i + 0.5)) {
                        ratingHtml += '&#10025;';
                    } else {
                        ratingHtml += '&#10029;';
                    }
                    infoNode.find('#iw-rating-row').css('display', '');
                    infoNode.find('#iw-rating').html(ratingHtml);
                }
            } else {
                infoNode.find('#iw-rating-row').css('display', 'none');
            }

            // The regexp isolates the first part of the URL (domain plus subdomain)
            // to give a short URL for displaying in the info window.
            if (place.website) {
                var fullUrl = place.website;
                var website = hostnameRegexp.exec(place.website);
                if (website === null) {
                    website = 'https://' + place.website + '/';
                    fullUrl = website;
                }
                infoNode.find('#iw-website-row').css('display', '');
                infoNode.find('#iw-website').text(website);
            } else {
                infoNode.find('#iw-website-row').css('display', 'none');
            }
            infoWindow.setContent(infoNode.html());
        }

        function getGeoCoderofPlace(pos) {
            map.setCenter(pos);
            map.panTo(pos);
            map.setZoom(15);
            marker = new google.maps.Marker({
                map: map,
                animation: google.maps.Animation.DROP,
                position: pos
            });
        }

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAhGVw8L8F8wfw8birJeGGAMgHZP4WaECE&libraries=places&callback=initMap"
    async defer></script>    
</html>